<ion-header>
    <ion-toolbar>
        <div class="contacts-header">
            <ion-text class="page-title">Cups Messenger</ion-text>               
            <ion-button color="primary" fill="clear" (click)="me()">
                <ion-icon name="settings-outline"></ion-icon>
            </ion-button>
        </div>   
    </ion-toolbar>
</ion-header>

<ion-content id="content" fullscreen>
    <ion-spinner *ngIf="$loading$ | async" class="center" name="crescent"></ion-spinner>

    <ion-item-group *ngIf="!($loading$ | async)">
        <div *ngFor="let contact of (contacts$ | async); index as i" >
            <ion-item-sliding>
                <ion-item minHeight="100px" class="item-contact" lines="full" detail='true' detail-icon="chevron-forward-outline" button (click)="jumpToChat(contact)">
                    <ion-avatar *ngIf="contact.unreadMessages === 0" class="item-avatar" slot="start">
                        <text-avatar [text]='(contact | truncateEllipses:12)'></text-avatar>
                    </ion-avatar>
                    <ion-avatar *ngIf="contact.unreadMessages > 0" class="item-avatar-unreads" slot="start">
                        <text-avatar [text]='(contact | truncateEllipses:12)'></text-avatar>
                    </ion-avatar>
                    <ion-grid>
                        <ion-row class="contact-name">{{ (contact | truncateEllipses:18) }}</ion-row>
                        <ion-row >
                            <div class="message-preview" *ngIf="contact.lastMessages[0]">{{ contact.lastMessages[0].text }}</div>
                            <div class="message-preview" *ngIf="!contact.lastMessages[0]">{{ "\t" }}</div>
                        </ion-row>
                    </ion-grid>
                </ion-item>
                <ion-item-options side="end" lines="full">
                    <ion-item-option color="medium" (click)="presentAlertDelete(contact)">Delete</ion-item-option>
                </ion-item-options>
            </ion-item-sliding>
        </div>
    </ion-item-group>

    <ion-fab class="ion-padding" vertical="bottom" horizontal="end" slot="fixed">
        <ion-fab-button class="new-contact-button" size="medium" fill="clear" color="primary" (click)="toNewContactPage()">
            <ion-icon name="add-outline"></ion-icon>
        </ion-fab-button>
    </ion-fab>
</ion-content>
