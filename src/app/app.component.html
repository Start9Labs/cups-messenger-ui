<ion-app>
    <ion-split-pane contentId="main-content">
        <ion-menu contentId="main-content" type="overlay">
            <ion-header>
                <ion-toolbar>
                    <ion-title>Cups Messenger V0</ion-title>
                </ion-toolbar>
            </ion-header>
            <ion-content>
                <ion-list *ngIf="globe.password">
                    <ion-menu-toggle auto-hide="false" *ngFor="let p of (globe.contacts$ | async)">
                        <ion-button *ngIf="(globe.currentContact$ | async)?.torAddress !== p.torAddress" expand="full" color="white" (click)="jumpToChat(p)">
                            <div style="position: fixed; left: 2%; color: #424242;">
                                {{
                                    (p | truncateEllipses:18:"shortDisplay")?.shortDisplay
                                }}
                            </div>
                            <div style="position: fixed; right: 2%; color: #424242;">
                                new: {{p.unreadMessages}}
                            </div>
                        </ion-button>
                        <ion-button *ngIf="(globe.currentContact$ | async)?.torAddress === p.torAddress" expand="full" color="slate">
                            <div style="position: fixed; left: 2%; color: #424242;">
                                {{
                                    (p | truncateEllipses:18:"shortDisplay")?.shortDisplay
                                }}
                            </div>
                        </ion-button>
                        <div style="min-height: 1px;"></div>
                    </ion-menu-toggle>

                    <ion-button *ngIf="!makeNewContactForm" expand="full" color="charcoal" fill="clear"
                        (click)="toggleNewContact()">
                        Add new contact
                        <ion-icon color="charcoal" name="add-circle" slot="end"></ion-icon>
                    </ion-button>

                    <ion-button *ngIf="makeNewContactForm" expand="full" color="charcoal" fill="clear"
                        (click)="toggleNewContact()">
                        <ion-icon color="charcoal" name="arrow-dropup"></ion-icon>
                    </ion-button>

                    <ion-item *ngIf="makeNewContactForm">
                        <ion-grid color="white">
                            <ion-row>
                                <ion-input type="text" [disabled]="submittingNewContact" placeholder="Contact Tor Address"
                                    [(ngModel)]="newContactTorAddress" name="message">
                                </ion-input>
                            </ion-row>
                            <ion-row>
                                <ion-input type="text" [disabled]="submittingNewContact" placeholder="Contact Name" [(ngModel)]="newContactName"
                                    name="message">
                                </ion-input>
                            </ion-row>
                            <ion-row>
                                <ion-button color="charcoal" [disabled]="submittingNewContact" (click)="submitNewContact()">
                                    submit
                                </ion-button>
                            </ion-row>
                        </ion-grid>
                    </ion-item>
                </ion-list>
            </ion-content>
        </ion-menu>
        <ion-router-outlet id="main-content"></ion-router-outlet>
    </ion-split-pane>
</ion-app>